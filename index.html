<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Product Store with Cart</title>
<style>
  /* Basic reset */
  * {
    box-sizing: border-box;
  }
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 0;
    background: #f4f6f8;
  }

  header {
    background-color: #2874f0;
    color: white;
    padding: 15px 20px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    position: sticky;
    top: 0;
    z-index: 1000;
  }
  header h1 {
    margin: 0;
    font-weight: 700;
    font-size: 1.6rem;
  }

  /* Cart button */
  #cart-btn {
    background: #fff;
    color: #2874f0;
    border: none;
    border-radius: 6px;
    padding: 8px 15px;
    font-weight: 600;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    box-shadow: 0 2px 5px rgb(40 116 240 / 0.4);
    transition: background 0.3s ease;
  }
  #cart-btn:hover {
    background: #e3eaff;
  }

  #cart-count {
    background: #ff3b3b;
    color: white;
    border-radius: 50%;
    padding: 3px 8px;
    font-size: 0.9rem;
    font-weight: 700;
  }

  main {
    max-width: 1200px;
    margin: 30px auto;
    padding: 0 20px;
  }

  /* Product grid */
  #products {
    display: grid;
    grid-template-columns: repeat(auto-fit,minmax(250px,1fr));
    gap: 20px;
  }

  .product {
    background: white;
    border-radius: 12px;
    box-shadow: 0 3px 7px rgb(0 0 0 / 0.1);
    padding: 15px;
    display: flex;
    flex-direction: column;
    transition: transform 0.2s ease;
  }
  .product:hover {
    transform: translateY(-5px);
  }
  .product img {
    max-width: 100%;
    height: 180px;
    object-fit: contain;
    margin-bottom: 12px;
  }
  .product h3 {
    font-size: 1.1rem;
    margin: 0 0 6px;
    flex-grow: 1;
  }
  .product p {
    font-size: 1rem;
    font-weight: 600;
    margin: 0 0 12px;
    color: #2874f0;
  }
  .product button {
    background: #2874f0;
    color: white;
    border: none;
    padding: 10px;
    border-radius: 6px;
    cursor: pointer;
    font-weight: 700;
    transition: background 0.3s ease;
  }
  .product button:hover {
    background: #1a54d8;
  }

  /* Cart sidebar */
  #cart-sidebar {
    position: fixed;
    top: 0;
    right: -400px;
    width: 380px;
    height: 100%;
    background: white;
    box-shadow: -4px 0 15px rgb(0 0 0 / 0.2);
    transition: right 0.3s ease;
    z-index: 2000;
    display: flex;
    flex-direction: column;
  }
  #cart-sidebar.open {
    right: 0;
  }

  #cart-sidebar header {
    padding: 20px;
    background: #2874f0;
    color: white;
    font-weight: 700;
    font-size: 1.4rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  #cart-sidebar header button {
    background: transparent;
    border: none;
    color: white;
    font-size: 1.6rem;
    cursor: pointer;
  }

  #cart-items {
    flex-grow: 1;
    overflow-y: auto;
    padding: 15px 20px;
  }

  .cart-item {
    display: flex;
    align-items: center;
    margin-bottom: 18px;
    border-bottom: 1px solid #eee;
    padding-bottom: 12px;
  }
  .cart-item img {
    width: 70px;
    height: 70px;
    object-fit: contain;
    border-radius: 8px;
    margin-right: 12px;
  }
  .cart-item-details {
    flex-grow: 1;
  }
  .cart-item-details h4 {
    margin: 0 0 6px;
    font-size: 1rem;
  }
  .cart-item-details p {
    margin: 0;
    font-weight: 600;
    color: #2874f0;
  }

  .cart-item-actions {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 6px;
  }
  .quantity-controls {
    display: flex;
    align-items: center;
    gap: 6px;
  }
  .quantity-controls button {
    width: 26px;
    height: 26px;
    font-size: 18px;
    background: #2874f0;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-weight: 700;
  }
  .quantity-controls span {
    min-width: 20px;
    text-align: center;
    font-weight: 600;
  }
  .remove-btn {
    background: #ff3b3b;
    border: none;
    color: white;
    border-radius: 5px;
    padding: 4px 8px;
    font-weight: 600;
    cursor: pointer;
    font-size: 0.85rem;
  }
  .remove-btn:hover {
    background: #d63131;
  }

  #cart-footer {
    padding: 20px;
    border-top: 1px solid #eee;
  }
  #cart-total {
    font-weight: 700;
    font-size: 1.2rem;
    margin-bottom: 15px;
  }
  #checkout-btn {
    width: 100%;
    padding: 12px;
    background: #2874f0;
    color: white;
    border: none;
    border-radius: 8px;
    font-weight: 700;
    cursor: pointer;
    font-size: 1rem;
    transition: background 0.3s ease;
  }
  #checkout-btn:hover {
    background: #1a54d8;
  }

  /* Responsive cart sidebar on small screens */
  @media (max-width: 450px) {
    #cart-sidebar {
      width: 100%;
    }
  }
</style>
</head>
<body>

<header>
  <h1>My Product Store</h1>
  <button id="cart-btn">
    ðŸ›’ Cart <span id="cart-count">0</span>
  </button>
</header>

<main>
  <div id="products">
    <!-- Products will load here -->
  </div>
</main>

<!-- Cart Sidebar -->
<div id="cart-sidebar" aria-hidden="true">
  <header>
    <span>My Cart</span>
    <button id="close-cart" aria-label="Close Cart">&times;</button>
  </header>
  <div id="cart-items">
    <!-- Cart items inserted here -->
  </div>
  <div id="cart-footer">
    <div id="cart-total">Total: $0.00</div>
    <button id="checkout-btn">Checkout</button>
  </div>
</div>

<script>
  const productsContainer = document.getElementById('products');
  const cartBtn = document.getElementById('cart-btn');
  const cartSidebar = document.getElementById('cart-sidebar');
  const closeCartBtn = document.getElementById('close-cart');
  const cartItemsContainer = document.getElementById('cart-items');
  const cartCountElem = document.getElementById('cart-count');
  const cartTotalElem = document.getElementById('cart-total');
  const checkoutBtn = document.getElementById('checkout-btn');

  let products = [];
  let cart = [];

  // Fetch products from free API
  async function fetchProducts() {
    try {
      const res = await fetch('https://fakestoreapi.com/products');
      products = await res.json();
      renderProducts();
    } catch (err) {
      productsContainer.innerHTML = "<p>Failed to load products.</p>";
      console.error(err);
    }
  }

  // Render products to DOM
  function renderProducts() {
    productsContainer.innerHTML = '';
    products.forEach(product => {
      const div = document.createElement('div');
      div.classList.add('product');
      div.innerHTML = `
        <img src="${product.image}" alt="${product.title}" />
        <h3>${product.title}</h3>
        <p>$${product.price.toFixed(2)}</p>
        <button data-id="${product.id}">Add to Cart</button>
      `;
      productsContainer.appendChild(div);
    });

    // Add event listeners to Add to Cart buttons
    document.querySelectorAll('.product button').forEach(button => {
      button.addEventListener('click', () => {
        const id = Number(button.getAttribute('data-id'));
        addToCart(id);
      });
    });
  }

  // Add product to cart
  function addToCart(id) {
    const product = products.find(p => p.id === id);
    if (!product) return;

    const existing = cart.find(item => item.id === id);
    if (existing) {
      existing.quantity++;
    } else {
      cart.push({ ...product, quantity: 1 });
    }
    updateCartUI();
    openCart();
  }

  // Update cart UI
  function updateCartUI() {
    cartItemsContainer.innerHTML = '';

    if (cart.length === 0) {
      cartItemsContainer.innerHTML = '<p>Your cart is empty.</p>';
      cartCountElem.textContent = '0';
      cartTotalElem.textContent = 'Total: $0.00';
      return;
    }

    let total = 0;
    cart.forEach(item => {
      total += item.price * item.quantity;

      const itemDiv = document.createElement('div');
      itemDiv.classList.add('cart-item');
      itemDiv.innerHTML = `
        <img src="${item.image}" alt="${item.title}" />
        <div class="cart-item-details">
          <h4>${item.title}</h4>
          <p>$${item.price.toFixed(2)}</p>
        </div>
        <div class="cart-item-actions">
          <div class="quantity-controls">
            <button class="qty-decrease" data-id="${item.id}">-</button>
            <span>${item.quantity}</span>
            <button class="qty-increase" data-id="${item.id}">+</button>
          </div>
          <button class="remove-btn" data-id="${item.id}">Remove</button>
        </div>
      `;
      cartItemsContainer.appendChild(itemDiv);
    });

    cartCountElem.textContent = cart.reduce((sum, i) => sum + i.quantity, 0);
    cartTotalElem.textContent = `Total: $${total.toFixed(2)}`;

    // Add event listeners to quantity buttons and remove buttons
    cartItemsContainer.querySelectorAll('.qty-increase').forEach(btn => {
      btn.addEventListener('click', () => changeQuantity(Number(btn.dataset.id), 1));
    });
    cartItemsContainer.querySelectorAll('.qty-decrease').forEach(btn => {
      btn.addEventListener('click', () => changeQuantity(Number(btn.dataset.id), -1));
    });
    cartItemsContainer.querySelectorAll('.remove-btn').forEach(btn => {
      btn.addEventListener('click', () => removeFromCart(Number(btn.dataset.id)));
    });
  }

  // Change quantity of an item in cart
  function changeQuantity(id, delta) {
    const item = cart.find(i => i.id === id);
    if (!item) return;
    item.quantity += delta;
    if (item.quantity < 1) item.quantity = 1;
    updateCartUI();
  }

  // Remove item from cart
  function removeFromCart(id) {
    cart = cart.filter(i => i.id !== id);
    updateCartUI();
  }

  // Open cart sidebar
  function openCart() {
    cartSidebar.classList.add('open');
    cartSidebar.setAttribute('aria-hidden', 'false');
  }
  // Close cart sidebar
  function closeCart() {
    cartSidebar.classList.remove('open');
    cartSidebar.setAttribute('aria-hidden', 'true');
  }

  // Checkout button click
  checkoutBtn.addEventListener('click', () => {
    if (cart.length === 0) {
      alert("Your cart is empty!");
      return;
    }
    alert(`Thank you for your purchase! Total: ${cartTotalElem.textContent.split(': ')[1]}`);
    cart = [];
    updateCartUI();
    closeCart();
  });

  cartBtn.addEventListener('click', () => {
    if (cartSidebar.classList.contains('open')) {
      closeCart();
    } else {
      openCart();
    }
  });

  closeCartBtn.addEventListener('click', closeCart);

  // Close cart if clicked outside cart on small screens
  window.addEventListener('click', e => {
    if (cartSidebar.classList.contains('open') && !cartSidebar.contains(e.target) && e.target !== cartBtn) {
      closeCart();
    }
  });

  // Initial fetch products
  fetchProducts();
</script>
</body>
</html>
